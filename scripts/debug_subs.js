
const { initializeApp, cert } = require('firebase-admin/app');
const { getFirestore } = require('firebase-admin/firestore');

const FB_SERVICE_ACCOUNT_KEY_B64 = "eyJ0eXBlIjoic2VydmljZV9hY2NvdW50IiwicHJvamVjdF9pZCI6InN0YWl0dW5lZC1wcm9kdWN0aW9uIiwicHJpdmF0ZV9rZXlfaWQiOiJhYTllNzQ2Y2EwYzhhNDM0NzE2NTBlYjc3ODQ5YmNhODE2YmM1Mjc1IiwicHJpdmF0ZV9rZXkiOiItLS0tLUJFR0lOIFBSSVZBVEUgS0VZLS0tLS1cbk1JSUV2d0lCQURBTkJna3Foa2lHOXcwQkFRRUZBQVNDQktrd2dnU2xBZ0VBQW9JQkFRRFVkcWNsZXFFWE81OFlcbjFqTFAzak12clE1bkI5MFNNUlFXYUNDNGpyUzFCVTliNFNIQ2ZmVm5HZVF1YXZJWnBCeXpZdGd6ZVUwaUIwNXBcbmt4TmxrYm5ZUUhoTXVDNTdHR2dQMEllSEtiQytwMEc3K21ITWlDSjExdTVvTTNlU3Z0Z0Y3UmF6TzJXdGs0bmZcbmxHTE9ucHJWL3k1ZGJMd3lBdEt4Z0t4UTU5TDB6NS9HcEZBc0VqMStxYkw1OUsyNUV3ZjUzM2g1WmtWRTVrRWJcblk0c0gvTTBKU2FIek1Fd3g4WlhzTHJTOWxDUUdwc05ETjhOTWZvSEdnVU80enRwZUxxS3lkVStrWlJGeEpueWZcbnUvQUR0UW5wV3FhSjMreTVaNGFMbjREUE5SZkkwWmo1NmlnTnJ3VW1qOCtXRElYRUU5WFB5UDJGbURoU2xKWmhcbnl0YnBQcWQ1QWdNQkFBRUNnZ0VBQk5ycHhxamEyOHF1WCsxTUo3VWtqdzA1dUNmRk9PUlRlTkFjR0UrVmlGSDBcbjNtMENmaHp1QWRORkJEMElKNGNaSzAzQjBrcE9OWTM4Y0J2dTdHb2tPTEYvZGtSYXRwQW9GNTFzclcxcDF5K0FcbkNHMUlOUm55ektYUzJLRjlkT1premh6ZEFROUZTMjVFenkzSFJNQzUyZFJOSVZBcDdFd2xkNjR3c2VBY1VXRVBcbkUrSnp6aXFyMUNRckVEdEZwZEx5VS9ZTjkzNVpWc3lUYnFOUTg0T2YzczF2S3p3cER2LzUxc0ZwOXltWmdIN0dcblppSHNXSjJqQXdtR0ZQRmMvQUdDUnNkS3Bwd3RITmt5dUs5dk5GeEpMbUs2Ym10Z2x3WGt6UjJ1ZEFsdEp1OEpcbk05NmZsMmRLTnJNU3lHOWlxUjF3eEZvVTBJYlhzVlQ4QVBNNnZ6ZkFFUUtCZ1FEdzZ4ZE5DYTJJREZmYkNmU2pcbm5WUnEvRnFaVmxFT1czYnVMTGptaXJhd3ZzTWl2N1FBd3hHdjZQNmU2REhvcnJPQVZ3MCtqVFl1QjNnQ3ZWWWxcbjhyRW5vWDNPREVvZmdvbVI4bGt6ck5hdS8wV3ZKNHVhbjJsNkFuYXZIeXJpbjNqY2ZBRUJFbFJ3dnNSQ1YyWGVcbmJwbGgrc3IwZ21YQjVEKzZZeFIxWkl0aGFRS0JnUURodzR6azhZMVVHOE1JZXI1eENmanJiRzlJSUlkb2FtWjFcbnMrMnk1Z0MxVmRHOFRidHkwLy9ldFVMa3NvWFNvTlE3cHZJTWZITHV6S1FVMG5TNHR6ZHZBa0Vyd2ZqRElqODdcbktud3o3SFkwVnJUbzFFVTc0QmNVSHBVKzRSa2NhNzY0UnZ2d3o3NExrbXFSdFlKVm9EUVJYV2VsWVZ0U1pjRWNcbnRMaUcxWjVEa1FLQmdRRGRBRnU4b004ZVNXeGlrNnhtVnRIMDNvL2hyOHZsWnNRZjBzaS9PNnBCVW8xQkdDaHdcbnRvRklKRzFHcW12MkxpU2Q2NzFMajFDUFF1eTFYcWhqWVZGZnNJWHVlVm1adEM2c3dtdFB1eEtwTDZUbCsxbldcbk9yd1FYNmd1RjJKSXg4K2dPdVRVN2RLbUptbDFEaVYxdVhGYzd5bzB5RlcrV3JxWEtZSy8rYjdlV1FLQmdRREZcbnNnVDJFcVFNekFhOHJTZUpPdzlUc08rOXZHWjJ3LzJYQW9tYXlCaEVzckxuN3pXL051L3Y2TkI4RGV4cjVsUVRcbkxIejIvQjkxQjVTRGUwdWsyU1BjdkordkhydWt2SitjUXZiaVRTV3hiV0FjSm8yK0FkeVR6TGdxaU5rQmIwUmlcbmdCNXM0SzN0MmpnaUFrendpRW93RHBnTlZUU3Y4ZFRxTzBML0o1N2dVUUtCZ1FDNUhoaUJpUEZLcFowTVo5bnZcblFnbzJSblkvclZqK2FGSUtVQzVOaDI3SHpKN1NlRkJvWVo2bW5xeVpaaTJaM2lkWERwdE1pYmFiNWpIWkp2a0lcbm5UUS9LQzRVdGN4SXljS3Zack9VVVowOE1LV0Ywbis1VCtjZFBTNDVnd0wwejlseVBNQ01QaXR2Q1dGd2NocFBcbjFLTTlzMSt0S1pWVEpjT0ludlFSL1M3d05RPT1cbi0tLS0tRU5EIFBSSVZBVEUgS0VZLS0tLS1cbiIsImNsaWVudF9lbWFpbCI6ImdhNC1hbmFseXRpY3MtcmVhZGVyQHN0YWl0dW5lZC1wcm9kdWN0aW9uLmlhbS5nc2VydmljZWFjY291bnQuY29tIiwiY2xpZW50X2lkIjoiMTE2NzkxMjE2MDM5NTAyMTU0NjExIiwiYXV0aF91cmkiOiJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20vby9vYXV0aDIvYXV0aCIsInRva2VuX3VyaSI6Imh0dHBzOi8vb2F1dGgyLmdvb2dsZWFwaXMuY29tL3Rva2VuIiwiYXV0aF9wcm92aWRlcl94NTA5X2NlcnRfdXJsIjoiaHR0cHM6Ly93d3cuZ29vZ2xlYXBpcy5jb20vb2F1dGgyL3YxL2NlcnRzIiwiY2xpZW50X3g1MDlfY2VydF91cmwiOiJodHRwczovL3d3dy5nb29nbGVhcGlzLmNvbS9yb2JvdC92MS9tZXRhZGF0YS94NTA5L2dhNC1hbmFseXRpY3MtcmVhZGVyJTQwc3RhaXR1bmVkLXByb2R1Y3Rpb24uaWFtLmdzZXJ2aWNlYWNjb3VudC5jb20iLCJ1bml2ZXJzZV9kb21haW4iOiJnb29nbGVhcGlzLmNvbSJ9";
const serviceAccount = JSON.parse(Buffer.from(FB_SERVICE_ACCOUNT_KEY_B64, 'base64').toString());

const app = initializeApp({
    credential: cert(serviceAccount)
});

const db = getFirestore(app, 'role-fit-audit');

async function check() {
    console.log('--- FIRESTORE CHECK ---');
    const snapshot = await db.collection('newsletter_subscribers').orderBy('subscribedAt', 'desc').limit(5).get();
    if (snapshot.empty) {
        console.log('No subscribers found.');
    }
    snapshot.forEach(doc => {
        const data = doc.data();
        console.log(`- Email: ${data.email} | Date: ${data.subscribedAt} | Source: ${data.source}`);
    });
}

check().catch(console.error);
